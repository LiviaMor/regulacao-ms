# DIAGRAMA DE FLUXO COMPLETO DO SISTEMA

## ğŸ”„ FLUXO VISUAL DETALHADO

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         1. ÃREA HOSPITALAR                              â”‚
â”‚                                                                         â”‚
â”‚  Hospital insere paciente com dados completos:                         â”‚
â”‚  â€¢ Nome, CPF, Telefone, Nome da MÃ£e                                   â”‚
â”‚  â€¢ CID, Especialidade, ProntuÃ¡rio                                     â”‚
â”‚  â€¢ HistÃ³rico, Prioridade                                              â”‚
â”‚                                                                         â”‚
â”‚  Endpoint: POST /solicitar-regulacao                                   â”‚
â”‚  Auth: Bearer Token (HOSPITAL/ADMIN)                                   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚ BANCO DE DADOS: pacientes_regulacao â”‚                              â”‚
â”‚  â”‚ Status: AGUARDANDO_REGULACAO        â”‚                              â”‚
â”‚  â”‚ Protocolo: REG-2025-XXX             â”‚                              â”‚
â”‚  â”‚ Timestamp: created_at               â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      2. ÃREA DE REGULAÃ‡ÃƒO - FILA                        â”‚
â”‚                                                                         â”‚
â”‚  Regulador visualiza fila de pacientes                                 â”‚
â”‚  Endpoint: GET /pacientes-hospital-aguardando                          â”‚
â”‚  Auth: Bearer Token (REGULADOR/ADMIN)                                  â”‚
â”‚                                                                         â”‚
â”‚  Filtro SQL: WHERE status = 'AGUARDANDO_REGULACAO'                    â”‚
â”‚  OrdenaÃ§Ã£o: Por prioridade (se jÃ¡ processado)                         â”‚
â”‚                                                                         â”‚
â”‚  Lista exibida:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ REG-2025-001 | CARDIOLOGIA | GOIANIA | Score: ?     â”‚             â”‚
â”‚  â”‚ REG-2025-002 | ORTOPEDIA   | ANAPOLIS | Score: ?    â”‚             â”‚
â”‚  â”‚ REG-2025-003 | NEUROLOGIA  | FORMOSA | Score: ?     â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    3. PROCESSAMENTO COM IA                              â”‚
â”‚                                                                         â”‚
â”‚  Regulador clica "Processar com IA"                                    â”‚
â”‚  Endpoint: POST /processar-regulacao                                    â”‚
â”‚  Auth: Bearer Token (REGULADOR/ADMIN)                                  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ 3.1 BioBERT (AnÃ¡lise de Entidades MÃ©dicas)                 â”‚      â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
â”‚  â”‚ Modelo: dmis-lab/biobert-base-cased-v1.1                   â”‚      â”‚
â”‚  â”‚ Entrada: prontuario_texto                                   â”‚      â”‚
â”‚  â”‚ SaÃ­da: Entidades mÃ©dicas + ConfianÃ§a                       â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Exemplo:                                                    â”‚      â”‚
â”‚  â”‚ "dor torÃ¡cica, sudorese, dispneia"                        â”‚      â”‚
â”‚  â”‚ â†’ Entidades: [dor_torÃ¡cica, sudorese, dispneia]          â”‚      â”‚
â”‚  â”‚ â†’ ConfianÃ§a: ALTA                                          â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ 3.2 AnÃ¡lise de CID e Sintomas                              â”‚      â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
â”‚  â”‚ CIDs CrÃ­ticos:                                              â”‚      â”‚
â”‚  â”‚ â€¢ I21 (IAM) â†’ Score +9, Risco VERMELHO                    â”‚      â”‚
â”‚  â”‚ â€¢ I46 (Parada) â†’ Score +10, Risco VERMELHO               â”‚      â”‚
â”‚  â”‚ â€¢ G93.1 (LesÃ£o Cerebral) â†’ Score +9, Risco VERMELHO      â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Sintomas CrÃ­ticos:                                          â”‚      â”‚
â”‚  â”‚ â€¢ "dor no peito" â†’ +3 pontos                              â”‚      â”‚
â”‚  â”‚ â€¢ "inconsciÃªncia" â†’ +4 pontos                             â”‚      â”‚
â”‚  â”‚ â€¢ "hemorragia" â†’ +3 pontos                                â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Score Final: 1-10                                           â”‚      â”‚
â”‚  â”‚ ClassificaÃ§Ã£o: VERMELHO/AMARELO/VERDE                      â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ 3.3 Pipeline Hospitais GoiÃ¡s                               â”‚      â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
â”‚  â”‚ FunÃ§Ã£o: selecionar_hospital_goias()                        â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ CritÃ©rios:                                                  â”‚      â”‚
â”‚  â”‚ â€¢ Especialidade disponÃ­vel                                  â”‚      â”‚
â”‚  â”‚ â€¢ Capacidade do hospital                                    â”‚      â”‚
â”‚  â”‚ â€¢ DistÃ¢ncia da origem                                       â”‚      â”‚
â”‚  â”‚ â€¢ Gravidade do caso                                         â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Hospitais Mapeados:                                         â”‚      â”‚
â”‚  â”‚ 1. HOSPITAL ESTADUAL DR ALBERTO RASSI (HGG)               â”‚      â”‚
â”‚  â”‚ 2. HOSPITAL DE URGENCIAS DE GOIAS (HUGO)                  â”‚      â”‚
â”‚  â”‚ 3. HOSPITAL ESTADUAL DE FORMOSA                            â”‚      â”‚
â”‚  â”‚ ... (10 hospitais estaduais)                               â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ SaÃ­da: Hospital + Justificativa                            â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ 3.4 Llama 3 (Opcional - DecisÃ£o ClÃ­nica)                  â”‚      â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
â”‚  â”‚ Modelo: Llama 3 via Ollama                                 â”‚      â”‚
â”‚  â”‚ Prompt: Contexto completo do paciente                      â”‚      â”‚
â”‚  â”‚ SaÃ­da: JSON com decisÃ£o estruturada                        â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Se indisponÃ­vel: Sistema usa anÃ¡lise baseada em regras    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ RESULTADO DA IA                                             â”‚      â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
â”‚  â”‚ {                                                           â”‚      â”‚
â”‚  â”‚   "analise_decisoria": {                                   â”‚      â”‚
â”‚  â”‚     "score_prioridade": 8,                                 â”‚      â”‚
â”‚  â”‚     "classificacao_risco": "VERMELHO",                     â”‚      â”‚
â”‚  â”‚     "unidade_destino_sugerida": "HOSPITAL ESTADUAL...",   â”‚      â”‚
â”‚  â”‚     "justificativa_clinica": "Paciente com IAM..."        â”‚      â”‚
â”‚  â”‚   },                                                        â”‚      â”‚
â”‚  â”‚   "biobert_usado": true,                                   â”‚      â”‚
â”‚  â”‚   "matchmaker_logistico": {                                â”‚      â”‚
â”‚  â”‚     "acionar_ambulancia": true,                            â”‚      â”‚
â”‚  â”‚     "tipo_transporte": "USA"                               â”‚      â”‚
â”‚  â”‚   }                                                         â”‚      â”‚
â”‚  â”‚ }                                                           â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚ BANCO: historico_decisoes           â”‚                              â”‚
â”‚  â”‚ Salva decisÃ£o da IA para auditoria  â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    4. DECISÃƒO DO REGULADOR                              â”‚
â”‚                                                                         â”‚
â”‚  Regulador analisa sugestÃ£o da IA e decide:                           â”‚
â”‚  Endpoint: POST /decisao-regulador                                     â”‚
â”‚  Auth: Bearer Token (REGULADOR/ADMIN)                                  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   APROVAR    â”‚  â”‚    NEGAR     â”‚  â”‚   ALTERAR    â”‚                â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚                â”‚
â”‚  â”‚ Concorda com â”‚  â”‚ Discorda da  â”‚  â”‚ Muda hospitalâ”‚                â”‚
â”‚  â”‚ sugestÃ£o IA  â”‚  â”‚ sugestÃ£o IA  â”‚  â”‚ sugerido     â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚         â”‚                  â”‚                  â”‚                        â”‚
â”‚         â–¼                  â–¼                  â–¼                        â”‚
â”‚  Status:            Status:            Status:                        â”‚
â”‚  INTERNACAO_        REGULACAO_         INTERNACAO_                    â”‚
â”‚  AUTORIZADA         NEGADA             AUTORIZADA                     â”‚
â”‚                                                                         â”‚
â”‚  Vai para           Volta para         Vai para                       â”‚
â”‚  TransferÃªncia      Hospital           TransferÃªncia                  â”‚
â”‚                     Origem             (hospital alterado)            â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ BANCO: pacientes_regulacao                                  â”‚      â”‚
â”‚  â”‚ â€¢ Atualiza status                                           â”‚      â”‚
â”‚  â”‚ â€¢ Define unidade_destino                                    â”‚      â”‚
â”‚  â”‚ â€¢ Registra updated_at                                       â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ BANCO: historico_decisoes                                   â”‚      â”‚
â”‚  â”‚ â€¢ Salva decisao_ia (original)                              â”‚      â”‚
â”‚  â”‚ â€¢ Salva decisao_final (regulador)                          â”‚      â”‚
â”‚  â”‚ â€¢ Registra usuario_validador                               â”‚      â”‚
â”‚  â”‚ â€¢ Timestamp completo                                        â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   5. ÃREA DE TRANSFERÃŠNCIA                              â”‚
â”‚                                                                         â”‚
â”‚  Paciente APROVADO aparece aqui automaticamente                        â”‚
â”‚  Endpoint: GET /pacientes-transferencia                                â”‚
â”‚  Auth: Bearer Token (REGULADOR/ADMIN)                                  â”‚
â”‚                                                                         â”‚
â”‚  Filtro SQL: WHERE status IN ('INTERNACAO_AUTORIZADA',                â”‚
â”‚                                'EM_TRANSFERENCIA')                     â”‚
â”‚                                                                         â”‚
â”‚  Lista exibida:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ REG-2025-001 | CARDIOLOGIA | VERMELHO                    â”‚         â”‚
â”‚  â”‚ Origem: HOSPITAL MUNICIPAL GOIANIA                        â”‚         â”‚
â”‚  â”‚ Destino: HOSPITAL ESTADUAL DR ALBERTO RASSI              â”‚         â”‚
â”‚  â”‚ Status: INTERNACAO_AUTORIZADA                            â”‚         â”‚
â”‚  â”‚ AmbulÃ¢ncia: PENDENTE                                      â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚ [ğŸš‘ SOLICITAR AMBULÃ‚NCIA]                                â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   6. SOLICITAR AMBULÃ‚NCIA                               â”‚
â”‚                                                                         â”‚
â”‚  Regulador/Coordenador clica "Solicitar AmbulÃ¢ncia"                   â”‚
â”‚  Endpoint: POST /solicitar-ambulancia                                  â”‚
â”‚  Auth: Bearer Token (REGULADOR/ADMIN)                                  â”‚
â”‚                                                                         â”‚
â”‚  Escolhe tipo de transporte:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚     USA      â”‚  â”‚     USB      â”‚  â”‚  AEROMÃ‰DICO  â”‚                â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚                â”‚
â”‚  â”‚ Suporte      â”‚  â”‚ Suporte      â”‚  â”‚ HelicÃ³ptero  â”‚                â”‚
â”‚  â”‚ AvanÃ§ado     â”‚  â”‚ BÃ¡sico       â”‚  â”‚              â”‚                â”‚
â”‚  â”‚ (UTI mÃ³vel)  â”‚  â”‚              â”‚  â”‚              â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ BANCO: pacientes_regulacao                                  â”‚      â”‚
â”‚  â”‚ â€¢ status â†’ EM_TRANSFERENCIA                                 â”‚      â”‚
â”‚  â”‚ â€¢ tipo_transporte â†’ USA/USB/AEROMÃ‰DICO                     â”‚      â”‚
â”‚  â”‚ â€¢ status_ambulancia â†’ SOLICITADA                           â”‚      â”‚
â”‚  â”‚ â€¢ data_solicitacao_ambulancia â†’ NOW()                      â”‚      â”‚
â”‚  â”‚ â€¢ observacoes_transferencia â†’ texto                        â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                7. ACOMPANHAMENTO DA AMBULÃ‚NCIA                          â”‚
â”‚                                                                         â”‚
â”‚  Endpoint: POST /atualizar-status-ambulancia                           â”‚
â”‚  Auth: Bearer Token (REGULADOR/ADMIN)                                  â”‚
â”‚                                                                         â”‚
â”‚  Fluxo de Status:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  SOLICITADA â†’ A_CAMINHO â†’ NO_LOCAL â†’ TRANSPORTANDO      â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚      â†“            â†“           â†“            â†“             â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  Aguardando   AmbulÃ¢ncia   Chegou no   Paciente em      â”‚         â”‚
â”‚  â”‚  ambulÃ¢ncia   a caminho    hospital    transporte       â”‚         â”‚
â”‚  â”‚                            origem                         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                    â”‚                                    â”‚
â”‚                                    â–¼                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚                    CONCLUIDA                              â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  Paciente chegou ao hospital destino                     â”‚         â”‚
â”‚  â”‚                                                           â”‚         â”‚
â”‚  â”‚  BANCO: pacientes_regulacao                              â”‚         â”‚
â”‚  â”‚  â€¢ status â†’ INTERNADA                                    â”‚         â”‚
â”‚  â”‚  â€¢ data_internacao â†’ NOW()                               â”‚         â”‚
â”‚  â”‚  â€¢ status_ambulancia â†’ CONCLUIDA                         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                8. CONSULTA PÃšBLICA (ANONIMIZADA)                        â”‚
â”‚                                                                         â”‚
â”‚  CidadÃ£o/Familiar consulta status do paciente                         â”‚
â”‚  Endpoint: GET /consulta-publica/paciente/{busca}                     â”‚
â”‚  Auth: âŒ NÃƒO REQUER (pÃºblico)                                        â”‚
â”‚                                                                         â”‚
â”‚  Busca por:                                                            â”‚
â”‚  â€¢ Protocolo: REG-2025-001                                            â”‚
â”‚  â€¢ CPF: 12345678901                                                   â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ DADOS RETORNADOS (ANONIMIZADOS - LGPD)                     â”‚      â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚      â”‚
â”‚  â”‚ Protocolo: REG-2025-001                                     â”‚      â”‚
â”‚  â”‚ Nome: J*** d* S***                                          â”‚      â”‚
â”‚  â”‚ CPF: ***.***.*89-01                                         â”‚      â”‚
â”‚  â”‚ Telefone: (62) *****-**21                                   â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Status: EM_TRANSFERENCIA                                    â”‚      â”‚
â”‚  â”‚ Status AmbulÃ¢ncia: A_CAMINHO                                â”‚      â”‚
â”‚  â”‚ Tipo Transporte: USA                                        â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Especialidade: CARDIOLOGIA                                  â”‚      â”‚
â”‚  â”‚ ClassificaÃ§Ã£o Risco: VERMELHO                               â”‚      â”‚
â”‚  â”‚ Unidade Destino: HOSPITAL ESTADUAL DR ALBERTO RASSI        â”‚      â”‚
â”‚  â”‚                                                             â”‚      â”‚
â”‚  â”‚ Data SolicitaÃ§Ã£o: 27/12/2024 10:30                         â”‚      â”‚
â”‚  â”‚ AmbulÃ¢ncia Solicitada: 27/12/2024 11:15                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                         â”‚
â”‚  âœ… Dados pessoais ANONIMIZADOS (LGPD Art. 12)                        â”‚
â”‚  âœ… InformaÃ§Ãµes clÃ­nicas MANTIDAS (nÃ£o sÃ£o dados pessoais)            â”‚
â”‚  âœ… Status em TEMPO REAL                                               â”‚
â”‚  âœ… TransparÃªncia TOTAL do processo                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š RESUMO DO CICLO COMPLETO

| Etapa | Status Inicial | AÃ§Ã£o | Status Final | Onde Aparece |
|-------|---------------|------|--------------|--------------|
| 1 | - | Hospital insere | AGUARDANDO_REGULACAO | Fila RegulaÃ§Ã£o |
| 2 | AGUARDANDO_REGULACAO | IA processa | AGUARDANDO_REGULACAO | Fila RegulaÃ§Ã£o |
| 3 | AGUARDANDO_REGULACAO | Regulador aprova | INTERNACAO_AUTORIZADA | TransferÃªncia |
| 4 | INTERNACAO_AUTORIZADA | Solicita ambulÃ¢ncia | EM_TRANSFERENCIA | TransferÃªncia |
| 5 | EM_TRANSFERENCIA | AmbulÃ¢ncia conclui | INTERNADA | Consulta PÃºblica |
| 6 | INTERNADA | Paciente recebe alta | COM_ALTA | Consulta PÃºblica |

## ğŸ” SEGURANÃ‡A EM CADA ETAPA

| Etapa | AutenticaÃ§Ã£o | Dados | Auditoria |
|-------|-------------|-------|-----------|
| Hospital | JWT (HOSPITAL/ADMIN) | Completos | âœ… Registrado |
| RegulaÃ§Ã£o | JWT (REGULADOR/ADMIN) | Completos | âœ… Registrado |
| IA | JWT (REGULADOR/ADMIN) | Completos | âœ… Registrado |
| DecisÃ£o | JWT (REGULADOR/ADMIN) | Completos | âœ… Registrado |
| TransferÃªncia | JWT (REGULADOR/ADMIN) | Completos | âœ… Registrado |
| AmbulÃ¢ncia | JWT (REGULADOR/ADMIN) | Completos | âœ… Registrado |
| Consulta PÃºblica | âŒ Sem auth | Anonimizados | âœ… Registrado |

---

**Data**: 27/12/2024  
**Status**: âœ… FLUXO COMPLETO VALIDADO E FUNCIONANDO
